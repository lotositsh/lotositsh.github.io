!function(){"use strict";function e(e,{x:t,y:f,moduleSize:s},l){e.save(),e.fillStyle=l,e.beginPath(),e.arc(t,f,.5*s,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}function t(e,t,f,s){e.save(),e.lineWidth=1,e.lineCap="square",e.lineJoin="miter",e.strokeStyle=f;let[l]=t,{length:o}=t;e.beginPath(),e.moveTo(l.x,l.y);for(let f=1;f<o;f++){let{x:s,y:l}=t[f];e.lineTo(s,l)}s&&e.closePath(),e.stroke(),e.restore()}self.addEventListener("message",({data:f})=>{let{image:s,items:l}=f,o=new OffscreenCanvas(s.width,s.height),a=o.getContext("2d");for(let{timing:f,corners:o,finder:n,alignment:r}of(a.drawImage(s,0,0),l))t(a,o,"#00ff00",!0),t(a,[n[2],n[0],n[1]],"#ff0000"),t(a,[f[2],f[0],f[1]],"#00ff00"),e(a,n[0],"#ff0000"),e(a,n[1],"#00ff00"),e(a,n[2],"#0000ff"),null!=r&&e(a,r,"#ff00ff");o.convertToBlob().then(e=>{let t={type:"ok",payload:URL.createObjectURL(e)};self.postMessage(t)},()=>{self.postMessage({type:"error",message:"生成未知定位图失败"})})})}();